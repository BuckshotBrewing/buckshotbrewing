
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Buckshot Brewing</title>

<style>
  body{
    margin:0;
    font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;
    background:#070a09;
    color:#fff;
    overflow-x:hidden;
  }

  body::before{
    content:"";
    position:fixed;
    inset:0;
    background:
      radial-gradient(900px 600px at 20% 0%, rgba(199,161,74,.25), transparent 60%),
      radial-gradient(800px 600px at 80% 10%, rgba(26,110,87,.2), transparent 60%);
    z-index:-1;
  }

  .site{
    transition:filter .4s ease;
  }
  .site.blur{
    filter:blur(12px);
    pointer-events:none;
    user-select:none;
  }

  .gate{
    position:fixed;
    inset:0;
    background:rgba(0,0,0,.75);
    display:flex;
    align-items:center;
    justify-content:center;
    z-index:999;
    padding:20px;
  }
  .gate-card{
    background:#0f1512;
    padding:44px;
    border-radius:24px;
    text-align:center;
    border:1px solid rgba(255,255,255,.12);
    box-shadow:0 40px 120px rgba(0,0,0,.6);
    width:min(720px, 100%);
  }
  .gate-card h1{
    margin:0 0 10px;
    font-size:34px;
    letter-spacing:-.3px;
  }
  .gate-card p{
    margin:0;
    color:rgba(255,255,255,.7);
    font-size:16px;
  }

  .btn{
    padding:14px 24px;
    border-radius:16px;
    border:none;
    font-weight:800;
    cursor:pointer;
    margin-top:18px;
  }
  .enter{
    background:#c7a14a;
    color:#000;
  }
  .leave{
    background:transparent;
    color:#fff;
    border:1px solid rgba(255,255,255,.18);
    margin-left:10px;
  }

  .transition{
    position:fixed;
    inset:0;
    background:#000;
    display:none;
    z-index:1000;
  }
  .transition.isPlaying{
    display:block;
  }
  .transition video{
    width:100%;
    height:100%;
    object-fit:cover;
    display:block;
    background:#000;
  }
  .loading{
    position:absolute;
    inset:0;
    display:grid;
    place-items:center;
    color:rgba(255,255,255,.75);
    font-weight:700;
    letter-spacing:.2px;
    text-align:center;
    padding:20px;
    pointer-events:none;
  }

  .hero{
    padding:110px 20px 30px;
    text-align:center;
  }
  .hero h1{
    font-size:56px;
    margin:0 0 10px;
    letter-spacing:-.6px;
  }
  .hero p{
    margin:0;
    color:rgba(255,255,255,.7);
    font-size:18px;
  }

  .stats{
    display:flex;
    justify-content:center;
    gap:60px;
    padding:35px 20px 70px;
    flex-wrap:wrap;
  }
  .stat{
    text-align:center;
    min-width:180px;
  }
  .stat b{
    display:block;
    font-size:32px;
  }
  .stat span{
    color:rgba(255,255,255,.7);
    font-weight:650;
  }

  @media(max-width:800px){
    .hero h1{font-size:38px;}
  }
</style>
</head>

<body>

<div id="ageGate" class="gate">
  <div class="gate-card">
    <h1>Are you 21+</h1>
    <p>You must be of legal drinking age to enter Buckshot Brewing.</p>
    <div>
      <button class="btn enter" id="yesBtn" type="button">Yes, Enter</button>
      <a class="btn leave" href="https://www.responsibility.org/" target="_blank" rel="noreferrer" style="text-decoration:none; display:inline-block;">No, Leave</a>
    </div>
  </div>
</div>

<div id="transition" class="transition" aria-hidden="true">
  <div class="loading" id="loadingText">Loading intro…</div>
  <video id="blastVideo" preload="auto" playsinline muted>
<source src="https://7be3fcdin3mtyulo.public.blob.vercel-storage.com/buckshot_intro_v17_full_logo.mp4" type="video/mp4">
  </video>
</div>

<div id="site" class="site blur">
  <div class="hero">
    <h1>Buckshot Brewing</h1>
    <p>Built for the outdoors. Party ready.</p>
  </div>

  <div class="stats">
    <div class="stat">
      <b id="stat1">0</b>
      <span>early supporters</span>
    </div>
    <div class="stat">
      <b id="stat2">0</b>
      <span>stores targeted</span>
    </div>
  </div>
</div>

<script>
  const STORAGE_KEY = "buckshot_age_verified_v1";

  const gate = document.getElementById("ageGate");
  const site = document.getElementById("site");
  const transition = document.getElementById("transition");
  const loadingText = document.getElementById("loadingText");
  const video = document.getElementById("blastVideo");
  const yesBtn = document.getElementById("yesBtn");

  function markVerified(){
    try { localStorage.setItem(STORAGE_KEY, "true"); } catch(e) {}
  }
  function isVerified(){
    try { return localStorage.getItem(STORAGE_KEY) === "true"; } catch(e) { return false; }
  }

  function enterWithoutVideo(){
    transition.classList.remove("isPlaying");
    transition.setAttribute("aria-hidden", "true");
    gate.style.display = "none";
    site.classList.remove("blur");
    markVerified();
    try { video.pause(); } catch(e) {}
  }

  async function playBlastThenEnter(){
    transition.classList.add("isPlaying");
    transition.setAttribute("aria-hidden", "false");
    loadingText.textContent = "Loading intro…";

    // Make sure browser actually loads it
    try { video.load(); } catch(e) {}

    // Hard fallback: if we are stuck in black screen, skip
    const hardTimeout = setTimeout(() => {
      loadingText.textContent = "Intro skipped.";
      enterWithoutVideo();
    }, 2500);

    const cleanup = () => {
      clearTimeout(hardTimeout);
      video.removeEventListener("ended", onEnd);
      video.removeEventListener("error", onErr);
      video.removeEventListener("stalled", onStall);
    };

    const onEnd = () => {
      cleanup();
      enterWithoutVideo();
    };

    const onErr = () => {
      cleanup();
      enterWithoutVideo();
    };

    const onStall = () => {
      // If it stalls, skip quickly instead of showing black forever
      cleanup();
      enterWithoutVideo();
    };

    video.addEventListener("ended", onEnd);
    video.addEventListener("error", onErr);
    video.addEventListener("stalled", onStall);

    try{
      video.currentTime = 0;
      const p = video.play();
      if (p && typeof p.then === "function") await p;
      loadingText.textContent = "";
    } catch(e){
      cleanup();
      enterWithoutVideo();
    }
  }

  // If already verified, do not show gate
  if (isVerified()){
    gate.style.display = "none";
    site.classList.remove("blur");
  }

  yesBtn.addEventListener("click", () => {
    playBlastThenEnter();
  });

  // Simple animated counters (runs after gate is dismissed)
  function animate(el,to){
    let startTime = null;
    const duration = 900;

    function step(ts){
      if (!startTime) startTime = ts;
      const t = Math.min(1, (ts - startTime) / duration);
      const eased = 1 - Math.pow(1 - t, 3);
      el.textContent = Math.floor(eased * to).toLocaleString();
      if (t < 1) requestAnimationFrame(step);
    }
    requestAnimationFrame(step);
  }

  animate(document.getElementById("stat1"), 1287);
  animate(document.getElementById("stat2"), 215);
</script>

</body>
</html>
